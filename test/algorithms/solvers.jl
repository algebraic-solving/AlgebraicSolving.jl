@testset "Algorithms -> Solvers" begin
    R, (x1,x2,x3,x4) = polynomial_ring(QQ,["x1","x2","x3","x4"], internal_ordering=:degrevlex)
    I = Ideal([x1 + 2*x2 + 2*x3 + 2*x4 - 1,
         x1^2 + 2*x2^2 + 2*x3^2 + 2*x4^2 - x1,
         2*x1*x2 + 2*x2*x3 + 2*x3*x4 - x2,
         x2^2 + 2*x1*x3 + 2*x2*x4 - x3])
    sols = Vector{QQFieldElem}[
        [5221121991829859395//9223372036854775808, 5504270848248823931//36893488147419103232, 9427746158008080579//36893488147419103232, -1773444330549010351039//9444732965739290427392],
         [16233410876972203325//36893488147419103232, 11332168696478546611//36893488147419103232, 3901864780605853159//36893488147419103232, -5021690718065612612481//37778931862957161709568],
         [1, 0, 0, 0],
         [27532799693394918193//36893488147419103232, 8613688565890011307//36893488147419103232, -6810831051238017945//36893488147419103232, 46039787397761586515//590295810358705651712],
         [6920971994354151069//36893488147419103232, 2890743263533053499//36893488147419103232, 2715165582075437623//36893488147419103232, 38421910449864642395061//151115727451828646838272],
         [12297829382473034411//36893488147419103232, 0, 0, 787061080478274202283//2361183241434822606848]
                            ]
    inter_sols = Vector{Vector{QQFieldElem}}[
        [[10442243983659718789//18446744073709551616, 10442243983659718791//18446744073709551616], [2752135424124411965//18446744073709551616, 1376067712062205983//9223372036854775808], [4713873079004040289//18446744073709551616, 2356936539502020145//9223372036854775808], [-27710067664828286735//147573952589676412928, -886722165274505175519//4722366482869645213696]],
         [[4058352719243050831//9223372036854775808, 8116705438486101663//18446744073709551616], [5666084348239273305//18446744073709551616, 2833042174119636653//9223372036854775808], [1950932390302926579//18446744073709551616, 487733097575731645//4611686018427387904], [-2510845359032806306241//18889465931478580854784, -39231958734887598535//295147905179352825856]],
         [[1, 1], [0, 0], [0, 0], [0, 0]],
         [[6883199923348729541//9223372036854775808, 13766399846697459111//18446744073709551616], [4306844282945005649//18446744073709551616, 2153422141472502829//9223372036854775808], [-212838470351188061//1152921504606846976, -3405415525619008969//18446744073709551616], [23019893698880793257//295147905179352825856, 11509946849440396629//147573952589676412928]],
         [[3460485997177075533//18446744073709551616, 216280374823567221//1152921504606846976], [1445371631766526749//18446744073709551616, 722685815883263375//9223372036854775808], [1357582791037718811//18446744073709551616, 339395697759429703//4611686018427387904], [9605477612466160598765//37778931862957161709568, 19210955224932321197531//75557863725914323419136]],
         [[3074457345618258583//9223372036854775808, 6148914691236517245//18446744073709551616], [-1//4611686018427387904, 1//4611686018427387904], [-5//18446744073709551616, 5//18446744073709551616], [393530540239137101141//1180591620717411303424, 196765270119568550571//590295810358705651712]]
                                            ]
    rat_sols = Vector{QQFieldElem}[[1, 0, 0, 0], [1//3, 0, 0, 1//3]]

    @test issetequal(sols, real_solutions(I))
    @test issetequal(inter_sols, real_solutions(I, interval=true))
    @test issetequal(rat_sols, rational_solutions(I))
    @test issetequal(I.real_sols, real_solutions(I))
    @test iszero(I.dim)

    C, x = polynomial_ring(QQ, "x")
    elim  = 128304*x^8 - 93312*x^7 + 15552*x^6 + 3144*x^5 - 1120*x^4 + 36*x^3 + 15*x^2 - x
    denom = 1026432*x^7 - 653184*x^6 + 93312*x^5 + 15720*x^4 - 4480*x^3 + 108*x^2 + 30*x - 1
    p1    = -3872448*x^7 + 2607552*x^6 - 408528*x^5 - 63088*x^4 + 20224*x^3 - 540*x^2 - 172*x + 7
    p2    = -303264*x^7 + 314928*x^6 - 113544*x^5 + 9840*x^4 + 3000*x^3 - 564*x^2 + 12*x
    p3    = -699840*x^7 + 449712*x^6 - 74808*x^5 - 1956*x^4 + 1308*x^3 - 174*x^2 + 18*x
    p1   *= -1//7
    p2   *= -1//7
    p3   *= -1//7

    param = rational_parametrization(I)

    @test param.vars == [:x1, :x2, :x3, :x4]
    @test param.cfs_lf == ZZRingElem[]
    @test param.elim == elim
    @test param.denom == denom
    @test param.param[1] == p1
    @test param.param[2] == p2
    @test param.param[3] == p3
    @test I.rat_param.elim == elim
    @test I.rat_param.denom == denom
    @test I.rat_param.param[1] == p1
    @test I.rat_param.param[2] == p2
    @test I.rat_param.param[3] == p3

    I = Ideal([x1^2-x2, x1*x3-x4, x2*x4-12, x4^3-x3^2])
    real_solutions(I)
    @test I.rat_param.vars == Symbol[]
    @test I.dim == -1

    I = Ideal([x1^2-x2, x1*x3, x2-12])
	@test_throws ErrorException real_solutions(I)
    @test_throws ErrorException real_solutions(I, interval=true)
	@test_throws ErrorException rational_solutions(I)
    @test isnothing(I.dim)

    R, (x, y) = polynomial_ring(QQ,["x","y"])
    # issue 54
    I = Ideal([R(0)])
	@test_throws ErrorException real_solutions(I)
    I = Ideal([x-1,y+2,R(0)])
    @test issetequal(real_solutions(I), Vector{QQFieldElem}[[1, -2]])

    # check variable permutation
    I = Ideal([x^2-1, y])
    sols = Vector{QQFieldElem}[
        [-1, 0],
        [1, 0]
            ]
    @test issetequal(sols, real_solutions(I))

    I = Ideal([x^2-1, y^2])
    @test issetequal(sols, real_solutions(I))
end
