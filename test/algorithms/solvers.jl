@testset "Algorithms -> Solvers" begin
    R, (x1,x2,x3,x4) = polynomial_ring(QQ,["x1","x2","x3","x4"], internal_ordering=:degrevlex)
    I = Ideal([x1 + 2*x2 + 2*x3 + 2*x4 - 1,
         x1^2 + 2*x2^2 + 2*x3^2 + 2*x4^2 - x1,
         2*x1*x2 + 2*x2*x3 + 2*x3*x4 - x2,
         x2^2 + 2*x1*x3 + 2*x2*x4 - x3])
    sols = Vector{QQFieldElem}[
        [4862548775//8589934592, 1281562925//8589934592, 2195068207//8589934592, -32714273694608759819673593948262790419337//174224571863520493293247799005065324265472],
        [3779635503//8589934592, 2638476131//8589934592, 908473689//8589934592, -92633843493479102248442236077889080803361//696898287454081973172991196020261297061888],
        [1, 0, 0, 0],
        [6410479475//8589934592, 2005530653//8589934592, -1585770177//8589934592, 55658687714722201275489356321691134094555601//713623846352979940529142984724747568191373312],
        [1611414365//8589934592, 673053615//8589934592, 632173751//8589934592, 708759148891639684402860468800417934359477//2787593149816327892691964784081045188247552],
        [2863311531//8589934592, 0, 0, 14518714321960041107770649917088777022123//43556142965880123323311949751266331066368]
                            ]
    inter_sols = Vector{Vector{QQFieldElem}}[
        [[2431274387//4294967296, 607818597//1073741824], [320390731//2147483648, 640781463//4294967296], [1097534103//4294967296, 137191763//536870912], [-16357136847304379909836796974131395209669//87112285931760246646623899502532662132736, -4089284211826094977459199243532848802417//21778071482940061661655974875633165533184]],
        [[1889817751//4294967296, 236227219//536870912], [1319238065//4294967296, 659619033//2147483648], [113559211//1073741824, 454236845//4294967296], [-46316921746739551124221118038944540401681//348449143727040986586495598010130648530944, -2894807609171221945263819877434033775105//21778071482940061661655974875633165533184]],
        [[1, 1], [0, 0], [0, 0], [0, 0]],
        [[3205239737//4294967296, 1602619869//2147483648], [501382663//2147483648, 1002765327//4294967296], [-792885089//4294967296, -24777659//134217728], [3478667982170137579718084770105695880909725//44601490397061246283071436545296723011960832, 27829343857361100637744678160845567047277801//356811923176489970264571492362373784095686656]],
        [[402853591//2147483648, 805707183//4294967296], [336526807//4294967296, 42065851//536870912], [316086875//4294967296, 79021719//1073741824], [177189787222909921100715117200104483589869//696898287454081973172991196020261297061888, 354379574445819842201430234400208967179739//1393796574908163946345982392040522594123776]],
        [[1431655765//4294967296, 715827883//2147483648], [-1//4294967296, 1//4294967296], [-1//4294967296, 1//4294967296], [7259357160980020553885324958544388511061//21778071482940061661655974875633165533184, 3629678580490010276942662479272194255531//10889035741470030830827987437816582766592]]
                                            ]
    rat_sols = Vector{QQFieldElem}[[49, 0, 0, 0], [49//3, 0, 0, 1//3]]

    @test sols == real_solutions(I)
    @test inter_sols == real_solutions(I, interval=true)
    @test rat_sols == rational_solutions(I)
    @test I.real_sols == real_solutions(I)

    C, x = polynomial_ring(QQ, "x")
    elim  = 128304*x^8 - 93312*x^7 + 15552*x^6 + 3144*x^5 - 1120*x^4 + 36*x^3 + 15*x^2 - x
    denom = 1026432*x^7 - 653184*x^6 + 93312*x^5 + 15720*x^4 - 4480*x^3 + 108*x^2 + 30*x - 1
    p1    = -3872448*x^7 + 2607552*x^6 - 408528*x^5 - 63088*x^4 + 20224*x^3 - 540*x^2 - 172*x + 7
    p2    = -303264*x^7 + 314928*x^6 - 113544*x^5 + 9840*x^4 + 3000*x^3 - 564*x^2 + 12*x
    p3    = -699840*x^7 + 449712*x^6 - 74808*x^5 - 1956*x^4 + 1308*x^3 - 174*x^2 + 18*x
    p1   *= -7
    p2   *= -7
    p3   *= -7

    param = rational_parametrization(I)

    @test param.vars == [:x1, :x2, :x3, :x4]
    @test param.lf_cfs == ZZRingElem[]
    @test param.elim == elim
    @test param.denom == denom
    @test param.param[1] == p1
    @test param.param[2] == p2
    @test param.param[3] == p3
    @test I.rat_param.elim == elim
    @test I.rat_param.denom == denom
    @test I.rat_param.param[1] == p1
    @test I.rat_param.param[2] == p2
    @test I.rat_param.param[3] == p3

    I = Ideal([x1^2-x2, x1*x3-x4, x2*x4-12, x4^3-x3^2])
    real_solutions(I)
    @test I.rat_param.vars == Symbol[]

    I = Ideal([x1^2-x2, x1*x3, x2-12])
	@test_throws ErrorException real_solutions(I)
    @test_throws ErrorException real_solutions(I, interval=true)
	@test_throws ErrorException rational_solutions(I)

    # check variable permutation
    R, (x, y) = polynomial_ring(QQ,["x","y"])
    I = Ideal([x^2-1, y])
    sols = Vector{QQFieldElem}[
        [-1, 0],
        [1, 0]
            ]
    @test sort(sols) == sort(real_solutions(I))

    I = Ideal([x^2-1, y^2])
    @test sort(sols) == sort(real_solutions(I))
end
