@testset "Algorithms -> Solvers" begin
    R, (x1,x2,x3,x4) = polynomial_ring(QQ,["x1","x2","x3","x4"], internal_ordering=:degrevlex)
    I = Ideal([x1 + 2*x2 + 2*x3 + 2*x4 - 1,
         x1^2 + 2*x2^2 + 2*x3^2 + 2*x4^2 - x1,
         2*x1*x2 + 2*x2*x3 + 2*x3*x4 - x2,
         x2^2 + 2*x1*x3 + 2*x2*x4 - x3])
    sols = Vector{QQFieldElem}[
        [9725097551//17179869184, 10252503395//68719476736, 8780272825//34359738368, -32714273694608759819673593948262790419337//174224571863520493293247799005065324265472],
        [15118542013//34359738368, 10553904527//34359738368, 14535579013//137438953472, -92633843493479102248442236077889080803361//696898287454081973172991196020261297061888],
        [1, 0, 0, 0],
        [12820958949//17179869184, 16044245225//68719476736, -12686161419//68719476736, 55658687714722201275489356321691134094555601//713623846352979940529142984724747568191373312],
        [12891314913//68719476736, 10768857835//137438953472, 10114780001//137438953472, 708759148891639684402860468800417934359477//2787593149816327892691964784081045188247552],
        [11453246123//34359738368, 393751//45671926166590716193865151022383844364247891968, 5717949//182687704666362864775460604089535377456991567872, 14518714321960041107770649917088777022123//43556142965880123323311949751266331066368]
                            ]
    inter_sols = Vector{Vector{QQFieldElem}}[
        [[4862548775//8589934592, 607818597//1073741824], [5126251697//34359738368, 2563125849//17179869184], [1097534103//4294967296, 4390136413//17179869184], [-16357136847304379909836796974131395209669//87112285931760246646623899502532662132736, -4089284211826094977459199243532848802417//21778071482940061661655974875633165533184]],
        [[3779635503//8589934592, 7559271007//17179869184], [5276952263//17179869184, 659619033//2147483648], [3633894753//34359738368, 7267789507//68719476736], [-46316921746739551124221118038944540401681//348449143727040986586495598010130648530944, -2894807609171221945263819877434033775105//21778071482940061661655974875633165533184]],
        [[1, 1], [0, 0], [0, 0], [0, 0]],
        [[3205239737//4294967296, 6410479475//8589934592], [2005530653//8589934592, 8022122613//34359738368], [-3171540355//17179869184, -6343080709//34359738368], [3478667982170137579718084770105695880909725//44601490397061246283071436545296723011960832, 27829343857361100637744678160845567047277801//356811923176489970264571492362373784095686656]],
        [[402853591//2147483648, 6445657457//34359738368], [5384428917//68719476736, 2692214459//34359738368], [316086875//4294967296, 5057390001//68719476736], [177189787222909921100715117200104483589869//696898287454081973172991196020261297061888, 354379574445819842201430234400208967179739//1393796574908163946345982392040522594123776]],
        [[5726623061//17179869184, 2863311531//8589934592], [-3795019955//365375409332725729550921208179070754913983135744, 3801319971//365375409332725729550921208179070754913983135744], [-2148414955//182687704666362864775460604089535377456991567872, 2159850853//182687704666362864775460604089535377456991567872], [7259357160980020553885324958544388511061//21778071482940061661655974875633165533184, 3629678580490010276942662479272194255531//10889035741470030830827987437816582766592]]
                                            ]
    rat_sols = Vector{QQFieldElem}[[1, 0, 0, 0], [1//3, 0, 0, 1//3]]

    @test issetequal(sols, real_solutions(I))
    @test issetequal(inter_sols, real_solutions(I, interval=true))
    @test issetequal(rat_sols, rational_solutions(I))
    @test issetequal(I.real_sols, real_solutions(I))
    @test iszero(I.dim)

    C, x = polynomial_ring(QQ, "x")
    elim  = 128304*x^8 - 93312*x^7 + 15552*x^6 + 3144*x^5 - 1120*x^4 + 36*x^3 + 15*x^2 - x
    denom = 1026432*x^7 - 653184*x^6 + 93312*x^5 + 15720*x^4 - 4480*x^3 + 108*x^2 + 30*x - 1
    p1    = -3872448*x^7 + 2607552*x^6 - 408528*x^5 - 63088*x^4 + 20224*x^3 - 540*x^2 - 172*x + 7
    p2    = -303264*x^7 + 314928*x^6 - 113544*x^5 + 9840*x^4 + 3000*x^3 - 564*x^2 + 12*x
    p3    = -699840*x^7 + 449712*x^6 - 74808*x^5 - 1956*x^4 + 1308*x^3 - 174*x^2 + 18*x
    p1   *= -1//7
    p2   *= -1//7
    p3   *= -1//7

    param = rational_parametrization(I)

    @test param.vars == [:x1, :x2, :x3, :x4]
    @test param.lf_cfs == ZZRingElem[]
    @test param.elim == elim
    @test param.denom == denom
    @test param.param[1] == p1
    @test param.param[2] == p2
    @test param.param[3] == p3
    @test I.rat_param.elim == elim
    @test I.rat_param.denom == denom
    @test I.rat_param.param[1] == p1
    @test I.rat_param.param[2] == p2
    @test I.rat_param.param[3] == p3

    I = Ideal([x1^2-x2, x1*x3-x4, x2*x4-12, x4^3-x3^2])
    real_solutions(I)
    @test I.rat_param.vars == Symbol[]
    @test I.dim == -1

    I = Ideal([x1^2-x2, x1*x3, x2-12])
	@test_throws ErrorException real_solutions(I)
    @test_throws ErrorException real_solutions(I, interval=true)
	@test_throws ErrorException rational_solutions(I)
    @test isnothing(I.dim)

    R, (x, y) = polynomial_ring(QQ,["x","y"])
    # issue 54
    I = Ideal([R(0)])
	@test_throws ErrorException real_solutions(I)
    I = Ideal([x-1,y+2,R(0)])
    @test issetequal(real_solutions(I), Vector{QQFieldElem}[[1, -2]])

    # check variable permutation
    I = Ideal([x^2-1, y])
    sols = Vector{QQFieldElem}[
        [-1, 0],
        [1, 0]
            ]
    @test issetequal(sols, real_solutions(I))

    I = Ideal([x^2-1, y^2])
    @test issetequal(sols, real_solutions(I))
end
